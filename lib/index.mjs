import e,{useRef as t,useMemo as n,useCallback as r,useState as a,useEffect as l}from"react";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n){return e>t?t:e<n?n:e}function u(e){if(!e.startsWith("#")){const t=document.createElement("canvas").getContext("2d");if(!t)throw new Error("2d context not supported or canvas already initialized");return t.fillStyle=e,t.fillStyle}return 4===e.length||5===e.length?e=e.split("").map(((e,t)=>t?e+e:"#")).join(""):7===e.length||9===e.length?e:"#000000"}function h(e){e=e.slice(1);const t=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16);let a=parseInt(e.slice(6,8),16)||void 0;return a&&(a/=255),{r:t,g:n,b:r,a:a}}function d({r:e,g:t,b:n,a:r}){e/=255,t/=255,n/=255;const a=Math.max(e,t,n),l=a-Math.min(e,t,n);return{h:l?60*(a===e?(t-n)/l+(t<n?6:0):a===t?2+(n-e)/l:4+(e-t)/l):0,s:a?l/a*100:0,v:100*a,a:r}}function p({r:e,g:t,b:n,a:r}){return`#${[e,t,n,r].map(((e,t)=>void 0!==e?(t<3?e:Math.round(255*e)).toString(16).padStart(2,"0"):"")).join("")}`}function g(e,t){let n=u("#121212"),r=h(n),a=d(r);if("hex"===e){n=u(t),r=h(n),a=d(r)}else if("rgb"===e){r=t,n=p(r),a=d(r)}else if("hsv"===e){a=t,r=function({h:e,s:t,v:n,a:r}){const a=~~(e/60),l=e/60-a,o=(n/=100)*(1-(t/=100)),c=n*(1-t*l),s=n*(1-t*(1-l)),i=a%6;return{r:Math.round(255*[n,c,o,o,s,n][i]),g:Math.round(255*[s,n,n,c,o,o][i]),b:Math.round(255*[o,o,s,n,n,c][i]),a:r}}(a),n=p(r)}return{hex:n,rgb:r,hsv:a}}const m=({className:n,style:r,onChange:a,children:l})=>{const o=t(null),c=(e,t=!1)=>{const n=(e=>{if(!o.current)return null;const{current:t}=o,{width:n,height:r,left:a,top:l}=t.getBoundingClientRect();return{x:i(e.clientX-a,n,0),y:i(e.clientY-l,r,0)}})(e);if(n){const{x:e,y:r}=n;a(e,r,t)}},s=e=>{c(e)};return e.createElement("div",{ref:o,className:n,style:r,onMouseDown:e=>{if(0!==e.button)return;s(e);const t=e=>{s(e)},n=e=>{document.removeEventListener("mousemove",t,!1),document.removeEventListener("mouseup",n,!1),c(e,!0)};document.addEventListener("mousemove",t,!1),document.addEventListener("mouseup",n,!1)}},l)},v=({width:t,color:r,onChange:a,onUpdated:l})=>{const o=n((()=>{var e;return function(e,t){return e*t}(null!==(e=r.hsv.a)&&void 0!==e?e:1,t)}),[r.hsv.a,t]),s=n((()=>`${r.rgb.r}, ${r.rgb.g}, ${r.rgb.b}`),[r.rgb]),i=n((()=>{var e;return`${s}, ${null!==(e=r.rgb.a)&&void 0!==e?e:1}`}),[s,r.rgb.a]),u=n((()=>-o-2),[o]);return e.createElement(m,{className:"rcp-alpha",onChange:(e,n,o)=>{const s=g("hsv",c(c({},r.hsv),{},{a:e/t}));a(s),o&&l(s)},style:{background:`linear-gradient(to right, rgba(${s}, 0), rgba(${s}, 1)) top left / auto auto,\n                conic-gradient(#666 0.25turn, #999 0.25turn 0.5turn, #666 0.5turn 0.75turn, #999 0.75turn) top left / 12px 12px\n                repeat`}},e.createElement("div",{className:"rcp-alpha-cursor",style:{left:o,background:`linear-gradient(to right, rgba(${i}), rgba(${i})) top left / auto auto,\n                conic-gradient(#666 0.25turn, #999 0.25turn 0.5turn, #666 0.5turn 0.75turn, #999 0.75turn) ${u}px 2px / 12px 12px\n                repeat`}}))},b=({width:t,height:r,color:a,onChange:l,onUpdated:o})=>{const s=n((()=>{const[e,n]=function(e,t,n){const{s:r,v:a}=e.hsv;return[r/100*t,(100-a)/100*n]}(a,t,r);return{x:e,y:n}}),[a,t,r]);return e.createElement(m,{className:"rcp-saturation",style:{height:r,backgroundColor:`hsl(${a.hsv.h}, 100%, 50%)`},onChange:(e,n,s)=>{const i=g("hsv",c(c({},a.hsv),{},{s:e/t*100,v:100-n/r*100}));l(i),s&&o(i)}},e.createElement("div",{className:"rcp-saturation-cursor",style:{left:s.x,top:s.y,backgroundColor:a.hex}}))},f=({width:t,color:r,onChange:a,onUpdated:l})=>{const o=n((()=>function(e,t){return e/360*t}(r.hsv.h,t)),[r.hsv.h,t]);return e.createElement(m,{className:"rcp-hue",onChange:(e,n,o)=>{const s=g("hsv",c(c({},r.hsv),{},{h:e/t*360}));a(s),o&&l(s)}},e.createElement("div",{className:"rcp-hue-cursor",style:{left:o,backgroundColor:`hsl(${r.hsv.h}, 100%, 50%)`}}))};function E(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}const y=/[0-9A-F]/i;const C=({color:t,hideHEX:n,hideLabels:o,onChange:s,onUpdated:i})=>{const u=r((()=>({value:t.hex,inputted:!1})),[t.hex]),[h,d]=a(u);l((()=>{h.inputted||d(u)}),[h.inputted,u]);return e.createElement(e.Fragment,null,!n&&e.createElement("div",{className:"rcp-fields-element hex-element"},e.createElement("input",{className:"rcp-fields-element-input",value:h.value,onFocus:()=>d(c(c({},h),{},{inputted:!0})),onChange:e=>{const t=e.target.value;if(function(e){return e.startsWith("#")?(e=e.slice(1),y.test(e[e.length-1])):/\w/i.test(e)&&!/\d/.test(e)||""===e}(t)){const e=g("hex",t);s(e),i(e),d(c(c({},h),{},{value:t}))}},onBlur:()=>d(c(c({},h),{},{inputted:!1}))}),o?null:e.createElement("label",{className:"rcp-fields-element-label"},"HEX")))},x=({color:t,hideRGB:n,hideHSV:o,alpha:s,hideLabels:u,onChange:h,onUpdated:d})=>{const p=r((()=>({value:`${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}${s&&void 0!==t.rgb.a?`, ${E(t.rgb.a,3)}`:""}`,inputted:!1})),[t.rgb,s]),m=r((()=>({value:`${Math.round(t.hsv.h)}Â°, ${Math.round(t.hsv.s)}%, ${Math.round(t.hsv.v)}%${s&&void 0!==t.hsv.a?`, ${E(t.hsv.a,3)}`:""}`,inputted:!1})),[t.hsv,s]),[v,b]=a(p),[f,y]=a(m);l((()=>{v.inputted||b(p)}),[v.inputted,p]),l((()=>{f.inputted||y(m)}),[f.inputted,m]);return e.createElement(e.Fragment,null,(!n||!o)&&e.createElement(e.Fragment,null,!n&&e.createElement("div",{className:"rcp-fields-element"},e.createElement("input",{className:"rcp-fields-element-input",value:v.value,onFocus:()=>b(c(c({},v),{},{inputted:!0})),onChange:e=>{const t=e.target.value.match(/\d+(?:\.\d+)?/g);if(t&&(3===t.length||s&&4===t.length)){const e=g("rgb",function(e){const[t,n,r,a]=e.map(((e,t)=>i(Number(e),t<3?255:1,0)));return{r:t,g:n,b:r,a:a}}(t));h(e),d(e)}b(c(c({},v),{},{value:e.target.value}))},onBlur:()=>b(c(c({},v),{},{inputted:!1}))}),u?null:e.createElement("label",{className:"rcp-fields-element-label"},"RGB")),!o&&e.createElement("div",{className:"rcp-fields-element"},e.createElement("input",{className:"rcp-fields-element-input",value:f.value,onFocus:()=>y(c(c({},f),{},{inputted:!0})),onChange:e=>{const t=e.target.value.match(/\d+(?:\.\d+)?/g);if(t&&(3===t.length||s&&4===t.length)){const e=g("hsv",function(e){const[t,n,r,a]=e.map(((e,t)=>i(Number(e),t?t<3?100:1:360,0)));return{h:t,s:n,v:r,a:a}}(t));h(e),d(e)}y(c(c({},f),{},{value:e.target.value}))},onBlur:()=>y(c(c({},f),{},{inputted:!1}))}),u?null:e.createElement("label",{className:"rcp-fields-element-label"},"HSV"))))},$=({color:t,hideHEX:n,hideRGB:r,hideHSV:a,alpha:l,hideLabels:o,onChange:c,onUpdated:s})=>e.createElement(e.Fragment,null,(!n||!r||!a)&&e.createElement("div",{className:"rcp-fields"},e.createElement(x,{color:t,hideRGB:r,hideHSV:a,alpha:l,hideLabels:o,onChange:c,onUpdated:s}),e.createElement(C,{color:t,hideHEX:n,hideLabels:o,onChange:c,onUpdated:s}))),w=(...e)=>{},N=({width:t,height:n=t,color:r,onChange:a,onUpdated:l,hideHEX:o=!1,hideRGB:c=!1,hideHSV:s=!1,alpha:i=!1,dark:u=!1,hideLabels:h=!1})=>(l=l||w,e.createElement("div",{className:"rcp "+(u?"rcp-dark":"rcp-light"),style:{width:t}},e.createElement(b,{width:t,height:n,color:r,onChange:a,onUpdated:l}),e.createElement("div",{className:"rcp-body"},e.createElement(f,{width:t-40,color:r,onChange:a,onUpdated:l}),i&&e.createElement(v,{width:t-40,color:r,onChange:a,onUpdated:l}),e.createElement($,{color:r,hideHEX:o,hideRGB:c,hideHSV:s,hideLabels:h,alpha:i,onChange:a,onUpdated:l}))));function O(e,t){const n=r((()=>{if("hex"===e){return g("hex",t)}if("rgb"===e){return g("rgb",t)}if("hsv"===e){return g("hsv",t)}return g("hex","#000000")}),[e,t]),[o,c]=a(n);return l((()=>{c(n)}),[n]),[o,c]}export{N as ColorPicker,g as toColor,O as useColor};
